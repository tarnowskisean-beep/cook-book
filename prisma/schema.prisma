generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Project {
  id              String   @id @default(uuid())
  title           String
  description     String?
  publicationDate DateTime?

  emoji           String   @default("üç≥") // Replaces coverImage
  isAutopilot     Boolean  @default(false)
  autopilotConfig String?  // JSON: { postsPerDay: number }
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  products        Product[]
  
  personaId       String?
  persona         Persona? @relation(fields: [personaId], references: [id])
}

// RENAMED: Was Recipe
model Product {
  id           String   @id @default(uuid())
  projectId    String
  name         String
  description  String?
  features     String   // Was ingredients. JSON or List of key specs.
  usage        String   // Was instructions. How to use it.
  images       String   // JSON string or comma-separated
  source       String?
  background   String?  // Was originStory. The "Why" or Backstory.
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  project      Project  @relation(fields: [projectId], references: [id])
  content      GeneratedContent[]
}

model Persona {
  id                String @id @default(uuid())
  name              String
  description       String? // Text description of personality
  visualDescription String? // Text description of appearance
  avatarImage       String? // URL of the generated avatar
  voiceId           String? // ElevenLabs or other voice ID
  
  projects          Project[]
}

model GeneratedContent {
  id                 String   @id @default(uuid())
  type               String   // VIDEO, IMAGE, CAPTION
  url                String?
  platform           String
  status             String   // DRAFT, SCHEDULED, POSTED
  performanceMetrics String?  // JSON
  productId          String
  
  product            Product  @relation(fields: [productId], references: [id])
  posts              Post[]
}

model SocialAccount {
  id          String   @id @default(uuid())
  platform    String   // TWITTER, INSTAGRAM, FACEBOOK, TIKTOK
  credentials String   // Encrypted
  status      String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Post {
  id            String    @id @default(uuid())
  contentId     String
  scheduledTime DateTime?
  publishedTime DateTime?
  platformPostId String?
  status        String    @default("DRAFT") // SCHEDULED, PUBLISHED, FAILED
  metrics       String?   // JSON
  
  content       GeneratedContent @relation(fields: [contentId], references: [id])
}
